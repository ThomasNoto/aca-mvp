<!-- <div class="flex flex-col items-center p-8 bg-slate-50 rounded-lg shadow-md">
  <img href="../assets/ACA_Flight_Tracker_Logo.png" alt="ACA Flight Tracker Logo" class="w-40 mb-4 drop-shadow-lg">
  <h1 class="text-3xl font-bold text-blue-700">ACA Flight Tracker</h1>
</div> -->

<div class="flex flex-col min-h-screen bg-slate-50 text-gray-800">
  <!-- header -->
  <header class="flex justify-between items-center px-8 py-4 bg-white shadow-md">
    <div class="flex items-center space-x-4">
      <div class="w-20 h-20 flex items-center justify-center rounded-md shadow-inner">
        <img src="/ACA_Flight_Tracker_Logo.png">
      </div>
      <h1 class="text-5xl font-bold text-blue-700 tracking-tight">ACA Flight Tracker</h1>
    </div>

    <!-- login dropdown -->
    <div class="relative">
      <button class="h-12 px-6 m-2 bg-blue-600 hover:bg-blue-700 text-lg text-white font-bold px-4 py-2 rounded-lg shadow"
        (click)="toggleDropdown()">
        @if (selectedUser) {
          Switch User
        } @else {
          Login ▼
        }
      </button>

      <!-- only show dropdown on login button click -->
      @if (isDropdownOpen) {
        @if (users$ | async; as users) {
          <div class="absolute right-0 top-full w-40 bg-white border rounded-lg shadow-md">
            @for (user of users; track user.id) {
              <div class="px-4 py-2 hover:bg-blue-50 cursor-pointer" 
                (click)="selectUser(user)">
                {{ user.name }}
              </div>
            }
          </div>
        }
      }
    </div>
  </header>

  <!-- main page -->
  <main class="flex flex-col items-center flex-1 p-8 space-y-6">
    @if (selectedUser) {
      <p class="text-lg font-semibold">Welcome, {{ selectedUser.name }}!</p>

      <div class="flex flex-col space-y-4">
        <form [formGroup]="searchFlightForm" (ngSubmit)="onFlightSearch()">
          <div class="flex flex-col">
            <label class="font-semibold text-sm mb-1">Origin</label>

            <input type="text" placeholder="Enter origin IATA..."
              id="origin_Airport_Iata"
              formControlName="origin_Airport_Iata"
              class="border border-gray-300 rounded-md px-4 py-2 w-48 focus:ring-2 focus:ring-blue-500 outline-none"/>
          </div>
          <div class="flex flex-col">
            <label class="font-semibold text-sm mb-1">Destination</label>

            <input type="text" placeholder="Enter destination IATA..."
              id="destination_Airport_Iata"
              formControlName="destination_Airport_Iata"
              class="border border-gray-300 rounded-md px-4 py-2 w-48 focus:ring-2 focus:ring-blue-500 outline-none"/>
          </div>
          <button type="button" (click)="onFlightSearch()"
            class="bg-blue-600 font-semibold text-white rounded-md px-4 py-2 mt-6 shadow hover:bg-blue-700 transition">
            {{ isClearing ? 'Clear' : (isSearching ? 'Search' : 'Search') }}
          </button>
        </form>
      </div>

      @if (flights.length > 0) {
      <div class="mt-8 w-full max-w-3xl">
        <h3 class="font-semibold text-lg mb-3">
          Showing results for: 
          <span class="text-blue-600 font-bold">{{ searchOrigin }}</span> 
          =>
          <span class="text-blue-600 font-bold">{{ searchDestination }}</span>
        </h3>

        <table class="min-w-full border border-gray-300 rounded-lg shadow-sm text-sm">
          <thead class="bg-gray-100">
            <tr>
              <th class="border px-4 py-2 text-left">Flight #</th>
              <th class="border px-4 py-2 text-left">Departure Time</th>
            </tr>
          </thead>

          <tbody>
            @for (f of flights.slice((currentPage - 1) * pageSize, currentPage * pageSize); track f) {
              <tr class="hover:bg-gray-50">
                <td class="border px-4 py-2">{{ f.flight_Number }}</td>
                <td class="border px-4 py-2">{{ f.departure_Time | date:'short' }}</td>
              </tr>
            }
          </tbody>
        </table>

        @if (flights.length > pageSize) {
          <div class="flex justify-between items-center mt-4">
            <button
              class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300"
              [disabled]="currentPage === 1"
              (click)="previousPage()"
            >
              ← Previous
            </button>

            <span class="text-sm text-gray-600">
              Page {{ currentPage }} of {{ totalPages }}
            </span>

            <button
              class="px-3 py-1 rounded bg-gray-200 hover:bg-gray-300"
              [disabled]="currentPage === totalPages"
              (click)="nextPage()"
            >
              Next →
            </button>
          </div>
        }
      </div>
    }

      <div class="mt-6">
        <button
          class="bg-blue-900 hover:bg-red-700 text-white font-semibold px-6 py-3 rounded-lg shadow transition"
          (click)="toggleCreateFlight()">
          {{ isCreatingFlight ? 'Cancel' : 'Create Flight' }}
        </button>
      </div>

      @if (isCreatingFlight) {
        <div class="transition-all duration-300 ease-in-out transform opacity-100 scale-100">
          <form [formGroup]="createFlightForm" (ngSubmit)="onFlightSubmit()" class="flex flex-col gap-4">
            <h2 class="text-2xl font-extrabold text-center text-gray-800 mb-4">Add Flight</h2>

            <div>
              <label for="flight_Number" class="block font-semibold text-gray-700 mb-1">Flight Number</label>
              <input
                type="text"
                id="flight_Number"
                formControlName="flight_Number"
                class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
            </div>

            <div>
              <label for="origin_Airport_Id" class="block font-semibold text-gray-700 mb-1">Origin Airport ID</label>
              <input
                type="number"
                id="origin_Airport_Id"
                formControlName="origin_Airport_Id"
                class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
            </div>

            <div>
              <label for="destination_Airport_Id" class="block font-semibold text-gray-700 mb-1">Destination Airport ID</label>
              <input
                type="number"
                id="destination_Airport_Id"
                formControlName="destination_Airport_Id"
                class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
            </div>

            <div>
              <label for="departure_Time" class="block font-semibold text-gray-700 mb-1">Departure Time</label>
              <input
                type="datetime-local"
                id="departure_Time"
                formControlName="departure_Time"
                class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500 focus:outline-none"
              />
            </div>

            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded-lg mt-4 shadow transition">
              Submit Flight
            </button>
          </form>
        </div>
      } @else {
        <div class="opacity-0 scale-95"></div>
      }
    } @else {
      <p class="text-2xl font-semibold text-blue-700 italic mt-10 text-center drop-shadow-sm">
        Please select a user via the login menu <br>
        in the top right to continue.
      </p>
    }
  </main>

  <!-- page footer -->
  <footer class="flex justify-center space-x-6 py-4 bg-gray-100 shadow-inner">
    <!-- hidden subliminal messaging so that you will hire me :) -->
    <p class="text-sm text-gray-100 italic mt-2 select-none">
      HIRE ME!
    </p>
    <!-- target="_blank" makes tab open in a new window-->
    <a href="http://localhost:8080/swagger"
      target="_blank"
      class="text-blue-600 hover:underline font-medium">
      Swagger API Docs
    </a>
    <p class="text-blue-600 hover:underline font-medium">|</p>
    <a href="https://github.com/ThomasNoto/aca-mvp"
      target="_blank"
      class="text-blue-600 hover:underline font-medium">
      GitHub Repo
    </a>
  </footer>
</div>